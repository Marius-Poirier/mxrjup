<div class="container">
    <header class="header">
        <a routerLink="/" class="back-link">&larr; INDEX</a>
        <div class="title">MEDIA ARCHIVE</div>
    </header>

    <div class="media-grid">
        @for (item of items(); track item.id) {
        <div class="media-item" (click)="openLightbox(item)">
            <div class="image-wrapper">
                @if (item.type === 'image' || item.type === 'video') {
                <img [src]="item.thumbnail" [alt]="item.title" loading="lazy">
                } @else if (item.type === 'audio') {
                <div class="audio-placeholder">
                    <span class="format-text">MP3</span>
                </div>
                }
            </div>
            <div class="meta">
                <span class="file-name">{{ item.title }}</span>
                <span class="file-type">[{{ item.type | uppercase }}]</span>
            </div>
        </div>
        } @empty {
        <div class="empty-state">NO MEDIA YET.</div>
        }
    </div>

    @if (activeItem(); as active) {
    <div class="lightbox" (click)="closeLightbox()">
        <div class="lightbox-content" (click)="$event.stopPropagation()">

            @if (active.type === 'image') {
            <img [src]="active.url" [alt]="active.title">
            } @else if (active.type === 'video') {
            <video [src]="active.url" controls autoplay></video>
            } @else if (active.type === 'audio') {
            <div class="audio-player">
                <div class="audio-icon">
                    <svg width="100%" height="100%" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                        <path d="M11 5L6 9H2V15H6L11 19V5Z" fill="black" stroke="black" stroke-width="2"
                            stroke-linejoin="round" />
                        <path
                            d="M15.54 8.46C16.4774 9.39764 17.004 10.6692 17.004 11.995C17.004 13.3208 16.4774 14.5924 15.54 15.53"
                            stroke="black" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                        <path
                            d="M19.07 4.93C20.9447 6.80527 21.998 9.34836 21.998 12C21.998 14.6516 20.9447 17.1947 19.07 19.07"
                            stroke="black" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" />
                    </svg>
                </div>
                <audio [src]="active.url" controls autoplay></audio>
            </div>
            }

            <div class="lightbox-meta">
                <span>{{ active.title }}</span>
                <button (click)="closeLightbox()">CLOSE [X]</button>
            </div>
        </div>
    </div>
    }
</div>